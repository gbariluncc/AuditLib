SELECT DISTINCT 
	LOWES.T618_VBU_RLT.T616_VBU_NBR1 AS SFVBU, 
	LOWES.T616_VBU.VBU_NME AS SFName, 
	LOWES.T618_VBU_RLT.T616_VBU_NBR2 AS HOVBU, 
	LOWES_T616_VBU_1.VBU_NME AS HOName, 
	LOWES.T617_VBU_FNC_TYP.T617_FNC_TYP_CD, 
	LOWES_T617_VBU_FNC_TYP_2.T617_FNC_TYP_CD, 
	LOWES_T617_VBU_FNC_TYP_1.T617_FNC_TYP_CD, 
	LOWES_T617_VBU_FNC_TYP_3.T617_FNC_TYP_CD, 
	LOWES.W001_PO_DAL_HDR.T063_LCT_NBR
FROM 
	LOWES.W001_PO_DAL_HDR 
		INNER JOIN ((((((LOWES.T618_VBU_RLT 
		INNER JOIN LOWES.T616_VBU AS LOWES_T616_VBU_1 
			ON LOWES.T618_VBU_RLT.T616_VBU_NBR2 = LOWES_T616_VBU_1.T616_VBU_NBR) 
			INNER JOIN LOWES.T616_VBU 
				ON LOWES.T618_VBU_RLT.T616_VBU_NBR1 = LOWES.T616_VBU.T616_VBU_NBR) 
				INNER JOIN LOWES.T617_VBU_FNC_TYP 
					ON LOWES.T618_VBU_RLT.T617_FNC_TYP_CD1 = LOWES.T617_VBU_FNC_TYP.T617_FNC_TYP_CD) 
					INNER JOIN LOWES.T617_VBU_FNC_TYP AS LOWES_T617_VBU_FNC_TYP_1 
					ON LOWES.T618_VBU_RLT.T617_FNC_TYP_CD2 = LOWES_T617_VBU_FNC_TYP_1.T617_FNC_TYP_CD) 
					INNER JOIN LOWES.T617_VBU_FNC_TYP AS LOWES_T617_VBU_FNC_TYP_2 
					ON LOWES.T616_VBU.T617_FNC_TYP_CD = LOWES_T617_VBU_FNC_TYP_2.T617_FNC_TYP_CD) 
					INNER JOIN LOWES.T617_VBU_FNC_TYP AS LOWES_T617_VBU_FNC_TYP_3 
						ON LOWES_T616_VBU_1.T617_FNC_TYP_CD = LOWES_T617_VBU_FNC_TYP_3.T617_FNC_TYP_CD) 
						ON LOWES.W001_PO_DAL_HDR.P028_VND_NBR = LOWES.T618_VBU_RLT.T616_VBU_NBR1
WHERE 
	(((LOWES.T618_VBU_RLT.T616_VBU_NBR2)={0}) 
	AND ((LOWES.T617_VBU_FNC_TYP.T617_FNC_TYP_CD)=1) 
	AND ((LOWES_T617_VBU_FNC_TYP_2.T617_FNC_TYP_CD)=1) 
	AND ((LOWES_T617_VBU_FNC_TYP_1.T617_FNC_TYP_CD)=2) 
	AND ((LOWES_T617_VBU_FNC_TYP_3.T617_FNC_TYP_CD)=2) 
	AND ((LOWES.W001_PO_DAL_HDR.T063_LCT_NBR)={1}));
